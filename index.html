<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>django model</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/black.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css">

    <style>
        .reveal h1 {
            text-transform: none;
        }
        .reveal h3 {
            text-transform: none;
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section><h1>Model In Django</h1></section>
        <section>
            <h3>Outline</h3>
            <ul>
                <li></li>
                <li></li>
                <li></li>
            </ul>
        </section>

        <section>
            <h3>Model</h3>
            <p>
                A model is the single, definitive source of information about your data. It contains the essential
                fields and behaviors of the data you’re storing. Generally, each model maps to a single database table.
                The basics:
            </p>
            <ul>
                <li>Each model is a Python class that subclasses django.db.models.Model.</li>
                <li>Each attribute of the model represents a database field.</li>
                <li>With all of this, Django gives you an automatically-generated database-access API; see Making
                    queries.</li>
            </ul>
            <a href="https://docs.djangoproject.com/en/5.0/topics/db/models/">doc</a>/
            <a href="https://www.w3schools.com/django/django_models.php">w3</a>/
            <a href="https://www.geeksforgeeks.org/django-models/">geeksforgeeks</a>
        </section>
        <section>
            <h3>Step 1: Install Django and Start a Project</h3>
            <p>
            <pre><code>pip install django
django-admin startproject myproject
cd myproject
python manage.py startapp myapp</code></pre>
            </p>
        </section>

        <section>
            <h3>Step 2: Update settings.py</h3>
            <p>Add django.contrib.auth and your app (myapp) to INSTALLED_APPS.</p>
            <pre><code>INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'myapp',
]
</code></pre>
        </section>

        <section>
            <section>
                <h3>Create Columns (Fields)</h3>
            </section>
            <section>
                <pre><code>from django.db import models


class Person(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)</code></pre>
            </section>
            <section>
                <p>you can change table name with class meta `db_table` <a
                        href="https://docs.djangoproject.com/en/5.0/ref/models/options/#table-names">link</a></p>
                <pre><code>CREATE TABLE myapp_person (
    "id" bigint NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "first_name" varchar(30) NOT NULL,
    "last_name" varchar(30) NOT NULL
);</code></pre>
            </section>
            <section>
                <p>should add app to installed_apps</p>
                <pre><code>INSTALLED_APPS = [
    # ...
    "myapp",
    # ...
]</code></pre>
            </section>
            <section>
                <p>until here: https://docs.djangoproject.com/en/5.0/topics/db/models/#field-options</p>
            </section>
        </section>

        <section>
            <section>
                <h3>Field Options</h3>
                <p>Each field takes a certain set of field-specific arguments (<a
                        href="https://docs.djangoproject.com/en/5.0/topics/db/models/#field-options">source</a>)</p>
                <p>For example, CharField (and its subclasses) require a max_length argument which specifies the size of the VARCHAR database field used to store the data.</p>
            </section>
            <section>
                <h3>Field Options</h3>
                <ul>
                    <li>null: If True, Django will store empty values as NULL in the database. Default is False.</li>
                    <li>blank: If True, the field is allowed to be blank. Default is False.</li>
                    <li>default: The default value for the field. This can be a value or a callable object. If callable it will be called every time a new object is created.</li>
                    <li>help_text: Extra “help” text to be displayed with the form widget. It’s useful for documentation even if your field isn’t used on a form.</li>
                    <li>primary_key: If True, this field is the primary key for the model.</li>
                    <li>unique: If True, this field must be unique throughout the table.</li>
                </ul>
                <p></p>
            </section>
            <section>
                <h3>blank vs null</h3>
                <p>Note that this is different than null. null is purely database-related, whereas blank is validation-related. If a field has blank=True, form validation will allow entry of an empty value. If a field has blank=False, the field will be required.</p>
            </section>
            <section>
                <h3>choices</h3>
                <p>A sequence of 2-value tuples, a mapping, an enumeration type, or a callable (that expects no arguments and returns any of the previous formats), to use as choices for this field. If this is given, the default form widget will be a select box instead of the standard text field and will limit choices to the choices given.</p>
                <pre><code>YEAR_IN_SCHOOL_CHOICES = [
    ("FR", "Freshman"),
    ("SO", "Sophomore"),
    ("JR", "Junior"),
    ("SR", "Senior"),
    ("GR", "Graduate"),
]</code></pre>
            </section>
            <section>
                <p>The first element in each tuple is the value that will be stored in the database. The second element is displayed by the field’s form widget.</p>
            </section>
            <section>
                <pre><code>from django.db import models


class Person(models.Model):
    SHIRT_SIZES = {
        "S": "Small",
        "M": "Medium",
        "L": "Large",
    }
    name = models.CharField(max_length=60)
    shirt_size = models.CharField(max_length=1, choices=SHIRT_SIZES)</code></pre>
            </section>
            <section>
                <a href="For example, CharField (and its subclasses) require a max_length argument which specifies the size of the VARCHAR database field used to store the data.">field options full list</a>
            </section>
            <section>
                <p></p>
                <p>By default, Django gives each model an auto-incrementing primary key with the type specified per app in AppConfig.default_auto_field or globally in the DEFAULT_AUTO_FIELD setting.
                    Automatic primary key fields. If you’d like to specify a custom primary key, specify primary_key=True on one of your fields. If Django sees you’ve explicitly set Field.primary_key, it won’t add the automatic id column.                    <a
                            href="https://docs.djangoproject.com/en/5.0/topics/db/models/#automatic-primary-key-fields">source</a></p>
            </section>
        </section>
        <section data-visibility="hidden">
            <h3>Verbose field names</h3>
            <a href="https://docs.djangoproject.com/en/5.0/topics/db/models/#verbose-field-names">source</a>
        </section>
        <section>Relationships</section>
        <section>
            <section><h3>Many-to-one relationships</h3>
                <p>For example, if a Car model has a Manufacturer – that is, a Manufacturer makes multiple cars but each
                    Car only has one Manufacturer – use the following definitions:</p>
                <pre><code data-line-numbers>from django.db import models


class Manufacturer(models.Model):
    # ...
    pass


class Car(models.Model):
    manufacturer = models.ForeignKey(Manufacturer, on_delete=models.CASCADE)
    # ...</code></pre>
            </section>

            <section>
                <p>It’s suggested, but not required, that the name of a ForeignKey field (manufacturer in the example above) be the name of the model, lowercase. You can call the field whatever you want. For example:</p>
                <pre><code data-line-numbers="2">class Car(models.Model):
    company_that_makes_it = models.ForeignKey(
        Manufacturer,
        on_delete=models.CASCADE,
    )
    # ...</code></pre>
            </section>
            <section data-visibility="hidden">
                <p>You can also create recursive relationships (an object with a many-to-one relationship to itself) and relationships to models not yet defined; see the model field reference for details.</p>
            </section>
        </section>
        <section>
            <section>
                <h3>Many-to-many relationships</h3>
            </section>
            <section>
                <p>For example, if a Pizza has multiple Topping objects – that is, a Topping can be on multiple pizzas and each Pizza has multiple toppings – here’s how you’d represent that:</p>
                <pre><code data-visibility="hidden">from django.db import models


class Topping(models.Model):
    # ...
    pass


class Pizza(models.Model):
    # ...
    toppings = models.ManyToManyField(Topping)
                </code></pre>
            </section>
            <section data-visibility="hidden">
                <p>As with ForeignKey, you can also create recursive relationships (an object with a many-to-many relationship to itself) and relationships to models not yet defined.</p>
            </section>
            <section>
                <p>It’s suggested, but not required, that the name of a ManyToManyField (toppings in the example above) be a plural describing the set of related model objects.</p>

                <p>It doesn’t matter which model has the ManyToManyField, but you should only put it in one of the models – not both.</p>
            </section>
            <section>
                <p>Generally, ManyToManyField instances should go in the object that’s going to be edited on a form. In the above example, toppings is in Pizza (rather than Topping having a pizzas ManyToManyField ) because it’s more natural to think about a pizza having toppings than a topping being on multiple pizzas. The way it’s set up above, the Pizza form would let users select the toppings.</p>
            </section>
            <section>
                <h3>arguments</h3>
                <a href="https://docs.djangoproject.com/en/5.0/ref/models/fields/#manytomany-arguments">source</a>
            </section>
            <section>
                <h3>Example</h3>
                <pre><code data-line-numbers="4-11|14-22">from django.db import models


class Publication(models.Model):
    title = models.CharField(max_length=30)

    class Meta:
        ordering = ["title"]

    def __str__(self):
        return self.title


class Article(models.Model):
    headline = models.CharField(max_length=100)
    publications = models.ManyToManyField(Publication)

    class Meta:
        ordering = ["headline"]

    def __str__(self):
        return self.headline</code></pre>
                <a href="https://docs.djangoproject.com/en/5.0/topics/db/examples/many_to_many/" target="_blank">source</a>
            </section>
            <section>
                <pre><code><script type="text/template">p1 = Publication(title="The Python Journal")
p1.save()
a1 = Article(headline="Django lets you build web apps easily")
a1.save()
a1.publications.add(p1)

a1.publications.all()
# <QuerySet [<Publication: The Python Journal>]>

p1.article_set.all()
# <QuerySet [<Article: Django lets you build web apps easily>, <Article: NASA uses Python>]>

>>> Publication.objects.get(id=4).article_set.all()
# <QuerySet [<Article: NASA uses Python>]>
</script></code></pre>
                <p>and lots of <a href="https://docs.djangoproject.com/en/5.0/topics/db/examples/many_to_many/">other</a> values</p>
            </section>
            <section>
                <h3>Extra fields on many-to-many relationships</h3>
                <p>For example, consider the case of an application tracking the musical groups which musicians belong to. There is a many-to-many relationship between a person and the groups of which they are a member, so you could use a ManyToManyField to represent this relationship. However, there is a lot of detail about the membership that you might want to collect, such as the date at which the person joined the group.</p>
            </section>
            <section>
                <p>For these situations, Django allows you to specify the model that will be used to govern the many-to-many relationship. You can then put extra fields on the intermediate model. The intermediate model is associated with the ManyToManyField using the through argument to point to the model that will act as an intermediary. For our musician example, the code would look something like this:</p>
            </section>
            <section>
                <pre><code data-line-numbers>from django.db import models


class Person(models.Model):
    name = models.CharField(max_length=128)

    def __str__(self):
        return self.name


class Group(models.Model):
    name = models.CharField(max_length=128)
    members = models.ManyToManyField(Person, through="Membership")

    def __str__(self):
        return self.name


class Membership(models.Model):
    person = models.ForeignKey(Person, on_delete=models.CASCADE)
    group = models.ForeignKey(Group, on_delete=models.CASCADE)
    date_joined = models.DateField()
    invite_reason = models.CharField(max_length=64)</code></pre>
            </section>
        </section>
        <section>
            <section>
                <h3>One-to-one relationships</h3>
                <p>This is most useful on the primary key of an object when that object “extends” another object in some way.</p>
            </section>
            <section>
                <p>For example, if you were building a database of “places”, you would build pretty standard stuff such as address, phone number, etc. in the database. Then, if you wanted to build a database of restaurants on top of the places, instead of repeating yourself and replicating those fields in the Restaurant model, you could make Restaurant have a OneToOneField to Place (because a restaurant “is a” place; in fact, to handle this you’d typically use inheritance, which involves an implicit one-to-one relation).</p>
            </section>

        </section>

        <section>
            <section>
                <h3>class Meta</h3>
                <pre><code data-line-numbers>from django.db import models


class Ox(models.Model):
    horn_length = models.IntegerField()

    class Meta:
        ordering = ["horn_length"]
        verbose_name_plural = "oxen"</code></pre>
            </section>
            <section>
                <p>Model metadata is “anything that’s not a field”, such as ordering options (ordering), database table name (db_table), or human-readable singular and plural names (verbose_name and verbose_name_plural). None are required, and adding class Meta to a model is completely optional.</p>
                <a href="https://docs.djangoproject.com/en/5.0/ref/models/options/">complete list</a>
            </section>
        </section>
        <section>
            <section>
                <h3>Model Methods</h3>
                <p>This is a valuable technique for keeping business logic in one place – the model.</p>

            </section>
            <section>
                <pre><code data-line-number>from django.db import models


class Person(models.Model):
    first_name = models.CharField(max_length=50)
    last_name = models.CharField(max_length=50)
    birth_date = models.DateField()

    def baby_boomer_status(self):
        "Returns the person's baby-boomer status."
        import datetime

        if self.birth_date < datetime.date(1945, 8, 1):
            return "Pre-boomer"
        elif self.birth_date < datetime.date(1965, 1, 1):
            return "Baby boomer"
        else:
            return "Post-boomer"

    @property
    def full_name(self):
        "Returns the person's full name."
        return f"{self.first_name} {self.last_name}"</code></pre>
            </section>
            <section>
                The last method in this example is a <a href="https://docs.djangoproject.com/en/5.0/glossary/#term-property">property</a>.
                <p>The model instance reference has a complete <a href="https://docs.djangoproject.com/en/5.0/ref/models/instances/#model-instance-methods">list of methods automatically given to each model</a>.</p>
            </section>
            <section>
                <h3>__str__()</h3>
                <p>A Python “magic method” that returns a string representation of any object. This is what Python and Django will use whenever a model instance needs to be coerced and displayed as a plain string. Most notably, this happens when you display an object in an interactive console or in the admin.</p>
                <p>You’ll always want to define this method; the default isn’t very helpful at all.</p>
            </section>
            <section>
                <h3>get_absolute_url()</h3>
                <p>This tells Django how to calculate the URL for an object. Django uses this in its admin interface, and any time it needs to figure out a URL for an object.</p>
                <p>Any object that has a URL that uniquely identifies it should define this method.</p>
            </section>
        </section>
        <section>
            <section>
                <h3><a href="https://docs.djangoproject.com/en/5.0/topics/db/models/#organizing-models-in-a-package">Organizing
                    models in a package</a></h3>
                <p>The manage.py startapp command creates an application structure that includes a models.py file. If you have many models, organizing them in separate files may be useful.</p>
                <p>To do so, create a models package. Remove models.py and create a myapp/models/ directory with an __init__.py file and the files to store your models. You must import the models in the __init__.py file.</p>
            </section>
            <section>
                <p>For example, if you had organic.py and synthetic.py in the models directory:</p>
                <pre><code>from .organic import Person
from .synthetic import Robot</code></pre>
                <p>Explicitly importing each model rather than using from .models import * has the advantages of not cluttering the namespace, making code more readable, and keeping code analysis tools useful.</p>
            </section>
        </section>
        <section>
            <h3>Learned Concepts</h3>
            <ul>
                <li>Define Model</li>
                <li>Model Fields</li>
                <li>Field Options</li>
                <li>many to one relationship</li>
                <li>many to many relationship</li>
                <li>Model Methods</li>
                <li>Meta Class</li>
            </ul>
        </section>
        <section>
            <h3>More Advanced Concepts</h3>
            <ul>
                <li><a href="https://docs.djangoproject.com/en/5.0/topics/db/models/#model-attributes">Manager</a></li>
                <li><a href="https://docs.djangoproject.com/en/5.0/topics/db/models/#overriding-predefined-model-methods">Overriding predefined model methods</a></li>
                <li><a href="https://docs.djangoproject.com/en/5.0/topics/db/models/#executing-custom-sql">raw sql</a></li>
                <li><a href="https://docs.djangoproject.com/en/5.0/ref/models/fields/#lazy-relationships">lazy relationship</a></li>
                <li><a href="https://docs.djangoproject.com/en/5.0/topics/db/queries/#lookups-that-span-relationships">lookups
                    that span relationship</a></li>
                <li><a href="https://docs.djangoproject.com/en/5.0/topics/db/models/#abstract-base-classes">inheritance
                    in models</a></li>
                <li><a href="https://docs.djangoproject.com/en/5.0/topics/db/models/#proxy-models">proxy models</a></li>
                <li>Multiple Inheritance</li>
            </ul>
        </section>
        <section>
            Mini Project 1: Create University Course Management System
        </section>
    </div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ],
        slideNumber: 'c/t',
    });
</script>
</body>
</html>
